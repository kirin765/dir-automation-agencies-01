---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const success = Astro.url.searchParams.get('submitted') === '1';
const error = Astro.url.searchParams.get('error');
---

<Layout title="Apply to List Your Agency - AI Automation Agencies Directory">
  <Header />

  <main class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <h1 class="text-3xl font-bold mb-4">Apply to Join</h1>
    <p class="text-slate-400 mb-8">
      This directory shows only verified agencies. Submit your information first, and our team will review it within 48 hours.
    </p>

    {error && <p class="mb-4 text-red-400">Submission failed: {error}</p>}
    {success && <p class="mb-4 text-green-400">Your application is submitted. We will review and contact you soon.</p>}

    <form
      method="POST"
      action="/api/join-agency"
      class="space-y-6"
      data-track-form="join_form_submit"
    >
      <input type="text" name="hp" tabindex="-1" autocomplete="off" class="absolute -left-[9999px]" />
      <input type="hidden" name="cf-turnstile-response" value="" />

      <div>
        <label class="block text-sm text-slate-400 mb-2">Company Name *</label>
        <input name="companyName" required class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-slate-400 mb-2">City *</label>
          <input name="city" required class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
        </div>
        <div>
          <label class="block text-sm text-slate-400 mb-2">Country *</label>
          <input name="country" required class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
        </div>
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Platform Focus *</label>
        <div class="text-sm text-slate-300 space-y-2">
          <label class="inline-flex items-center gap-2 mr-4">
            <input type="checkbox" value="zapier" name="platforms" />
            Zapier
          </label>
          <label class="inline-flex items-center gap-2 mr-4">
            <input type="checkbox" value="make" name="platforms" />
            Make.com
          </label>
          <label class="inline-flex items-center gap-2 mr-4">
            <input type="checkbox" value="n8n" name="platforms" />
            n8n
          </label>
          <label class="inline-flex items-center gap-2 mr-4">
            <input type="checkbox" value="custom" name="platforms" />
            Custom
          </label>
          <label class="inline-flex items-center gap-2 mr-4">
            <input type="checkbox" value="ai" name="platforms" />
            AI/LLM
          </label>
        </div>
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Official Website *</label>
        <input name="website" required type="url" class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Contact Name *</label>
        <input name="contactName" required class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Contact Email *</label>
        <input name="contactEmail" required type="email" class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Contact Phone</label>
        <input name="contactPhone" class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Verification Evidence (Optional)</label>
        <input name="verificationEvidence" placeholder="Your website page link, social profile, or contract reference." class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white" />
      </div>

      <div>
        <label class="block text-sm text-slate-400 mb-2">Message *</label>
        <textarea
          name="message"
          required
          rows="5"
          class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white"
          placeholder="Tell us about your agency and key services."
        ></textarea>
      </div>

      <button type="submit" class="w-full px-6 py-3 bg-green-500 hover:bg-green-600 text-black font-semibold rounded-xl">
        Submit Application
      </button>
    </form>
  </main>

  <Footer />
</Layout>
